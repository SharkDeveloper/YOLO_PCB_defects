# GPU Test Scripts для YOLO

Эта директория содержит скрипты для диагностики и настройки GPU для работы с YOLO.

## Содержание

1. [Обзор](#обзор)
2. [Скрипты](#скрипты)
3. [Инструкции по использованию](#инструкции-по-использованию)
4. [Решение проблем](#решение-проблем)

## Обзор

Эти скрипты помогут вам:
- Диагностировать текущую конфигурацию GPU
- Установить необходимые компоненты CUDA и cuDNN
- Проверить совместимость версий
- Настроить среду для работы YOLO с GPU

## Скрипты

### 1. gpu_diagnostic.py
Скрипт для диагностики текущей конфигурации GPU и проверки установленных библиотек.

**Функции:**
- Проверка версии Python
- Проверка наличия CUDA и версии драйверов
- Проверка доступности PyTorch и TensorFlow для GPU
- Проверка установленных пакетов

### 2. install_cuda.py
Скрипт с инструкциями по установке CUDA Toolkit, совместимого с PyTorch 2.9.0.

**Функции:**
- Определение операционной системы
- Предоставление ссылок для загрузки подходящей версии CUDA
- Инструкции по установке для Windows, Linux и macOS

### 3. install_cudnn.py
Скрипт с инструкциями по установке cuDNN, совместимого с установленной версией CUDA.

**Функции:**
- Проверка установленной версии CUDA
- Предоставление ссылок для загрузки подходящей версии cuDNN
- Инструкции по установке для Windows, Linux и macOS

### 4. check_compatibility.py
Скрипт для проверки совместимости установленных версий CUDA, cuDNN и PyTorch.

**Функции:**
- Проверка версий установленных компонентов
- Анализ совместимости между компонентами
- Предоставление рекомендаций по устранению проблем

## Инструкции по использованию

### Шаг 1: Диагностика текущей конфигурации
```bash
python gpu_diagnostic.py
```
Этот скрипт покажет текущее состояние системы и установленные библиотеки.

### Шаг 2: Установка CUDA Toolkit
```bash
python install_cuda.py
```
Следуйте инструкциям для установки подходящей версии CUDA Toolkit.

**Важно:** Для PyTorch 2.9.0 рекомендуется использовать CUDA 11.8 или 12.1.

### Шаг 3: Установка cuDNN
```bash
python install_cudnn.py
```
Следуйте инструкциям для установки подходящей версии cuDNN.

### Шаг 4: Проверка совместимости
```bash
python check_compatibility.py
```
Этот скрипт проверит совместимость установленных компонентов.

### Шаг 5: Проверка работы GPU с YOLO
После установки всех компонентов проверьте доступность GPU:
```bash
python -c "import torch; print('CUDA доступна:', torch.cuda.is_available())"
```

Если CUDA доступна, вы можете запускать YOLO с использованием GPU:
```bash
yolo detect train ... --device 0
```

## Решение проблем

### Проблема 1: CUDA не обнаружена PyTorch
**Симптомы:**
- `torch.cuda.is_available()` возвращает `False`
- Сообщения об ошибках при попытке использовать GPU

**Решения:**
1. Убедитесь, что CUDA Toolkit установлен правильно
2. Проверьте переменные окружения (PATH, CUDA_PATH)
3. Убедитесь, что версия PyTorch совместима с установленной CUDA
4. Переустановите PyTorch с поддержкой CUDA:
   ```bash
   pip install torch==2.9.0 torchvision==0.24.0 --index-url https://download.pytorch.org/whl/cu118
   ```

### Проблема 2: Ошибки при установке nvidia-pyindex и nvidia-cudnn через pip
**Симптомы:**
- Ошибки сборки при установке пакетов
- Сообщения о недостающих зависимостях

**Решения:**
1. Обновите pip до последней версии:
   ```bash
   python -m pip install --upgrade pip
   ```
2. Установите пакеты в правильном порядке:
   ```bash
   pip install nvidia-pyindex
   pip install nvidia-cudnn
   ```
3. Если установка через pip не работает, установите cuDNN вручную с официального сайта NVIDIA

### Проблема 3: Проблемы с переменными окружения
**Симптомы:**
- CUDA не обнаруживается в PATH
- Ошибки при запуске nvidia-smi

**Решения:**
1. Добавьте пути к CUDA в переменную среды PATH:
   - Windows: `C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.8\bin`
   - Linux: `/usr/local/cuda-11.8/bin`
2. Установите переменную CUDA_PATH:
   - Windows: `C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.8`
   - Linux: `/usr/local/cuda-11.8`
3. Перезапустите терминал после изменения переменных окружения

### Проблема 4: Несовместимость версий
**Симптомы:**
- Ошибки при импорте torch
- Проблемы с запуском моделей на GPU

**Решения:**
1. Проверьте совместимость версий с помощью `check_compatibility.py`
2. Установите совместимые версии компонентов:
   - PyTorch 2.9.0: CUDA 11.8 или 12.1
   - cuDNN: 8.7.x для CUDA 11.8 или 8.9.x для CUDA 12.1

## Дополнительные ресурсы

- [Официальная документация CUDA](https://docs.nvidia.com/cuda/)
- [Официальная документация cuDNN](https://docs.nvidia.com/deeplearning/cudnn/)
- [Документация PyTorch по установке](https://pytorch.org/get-started/locally/)
- [Документация YOLO](https://docs.ultralytics.com/)

## Поддержка

Если у вас возникли проблемы, которые не решаются с помощью этих инструкций:

1. Запустите `gpu_diagnostic.py` и сохраните вывод
2. Проверьте, что все шаги из этого руководства выполнены
3. Обратитесь за дополнительной помощью, предоставив:
   - Вывод `gpu_diagnostic.py`
   - Версии установленных компонентов
   - Описание возникших проблем